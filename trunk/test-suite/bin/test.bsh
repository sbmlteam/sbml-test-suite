#!/bin/bash
#runs test based based on .test file

if [ $# != 2 ]; then
    echo "Usage: " $0 "<simulator wapper> <test file>"
    exit 1
fi

wrapper=$1
testfile=$2

if ! [ -e $testfile ] ; then 
    echo $testfile does not exist
    exit 1;
fi

if ! [ -e $wrapper ] ; then 
    echo $wrapper does not exist
    exit 1;
fi

originalcsv=$(echo $testfile | sed {s/.test/.CSV/})
if ! [ -e $originalcsv ] ; then
    echo $originalcsv does not exist
    exit 1
fi

sbml=$(echo $testfile | sed {s/.test/-l2.xml/})
if ! [ -e $sbml ] ; then
    echo $sbml does not exist
    exit 1
fi

mkdir -p temp
#echo "sbml=" $sbml
$wrapper $sbml $(createargs.awk $testfile)
#rm -r temp

if ! csv-comparator.bsh $originalcsv testout.CSV; then
    generateMessage.awk $testfile
    exit 1
fi
 
